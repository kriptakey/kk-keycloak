<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KK-Cryptoservice setup and configuration &mdash; Kripta Key Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b20cc3f5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=03d93ebb"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Disaster recovery" href="disaster-recovery.html" />
    <link rel="prev" title="Installing Kripta Key" href="kripta-key-installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Kripta Key Documentation
          </a>
              <div class="version">
                24.1.0015-RC-UP02
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../revision-history.html">Revision History</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kripta-key-primer.html">Kripta Key Primer</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installation Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#preface">Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="before-installing.html">Before deploying Kripta Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="kripta-key-installation.html">Installing Kripta Key</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">KK-Cryptoservice setup and configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#before-installing-kk-cryptoservice">Before installing KK-Cryptoservice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-kk-cryptoservice">Installing KK-Cryptoservice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#registering-kk-cryptoservice">Registering KK-Cryptoservice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="disaster-recovery.html">Disaster recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="appliance-deployment.html">Appliance model</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc-actions.html">Miscellaneous operations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../clikk-installation-guide/index.html">CLIKK Installation Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud-installation-guide/index.html">Cloud Installation Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kkts-guide/index.html">KK-TS Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tdp-installation-guide/index.html">TDP Installation Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license-guide/index.html">License Application Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sys-admin-guide/index.html">System Administrator Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev-guide/index.html">Developer Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../e2ee-dev-guide/index.html">E2EE Developer Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../func-module-guide/index.html">Functional Module Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../app-integration-guide/index.html">App Integration Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../keycloak-integration-guide/index.html">KeyCloak Integration Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sdk-api-docs/index.html">SDK API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rest-api-docs/index.html">REST API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../whitepaper/index.html">Whitepaper</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kripta Key Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Installation Guide</a></li>
      <li class="breadcrumb-item active">KK-Cryptoservice setup and configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/installation-guide/cryptographic-service-installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kk-cryptoservice-setup-and-configuration">
<h1>KK-Cryptoservice setup and configuration<a class="headerlink" href="#kk-cryptoservice-setup-and-configuration" title="Link to this heading"></a></h1>
<p>KK-Cryptoservice provides cryptographic services to applications. Authorized applications may connect
to the KK-Cryptoservice instances to perform cryptographic operations using keys that are stored
in the KK-Manager database or otherwise created by the KK-Manager.</p>
<p>This section describes the steps required to install and configure KK-Cryptoservice.</p>
<section id="before-installing-kk-cryptoservice">
<h2>Before installing KK-Cryptoservice<a class="headerlink" href="#before-installing-kk-cryptoservice" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Ensure that the server has been prepared as specified in <a class="reference internal" href="before-installing.html#preparatory-steps"><span class="std std-ref">Preparatory steps</span></a>.</p></li>
<li><p>Download the <a class="reference external" href="https://download.01.org/intel-sgx/sgx-linux/2.23/distro/rhel9.2-server/sgx_rpm_local_repo.tgz">Intel SGX Platform Software</a>. Run the following commands from the directory
where the archive is located:</p>
<ol class="arabic">
<li><p>Extract the packages.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tar<span class="w"> </span>-xvf<span class="w"> </span>sgx_rpm_local_repo.tgz
</pre></div>
</div>
</li>
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">sgx_rpm_local_repo</span></code> directory, and enable the repository.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>sgx_rpm_local_repo
<span class="gp">$ </span>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--add-repo<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>

<span class="go">Updating Subscription Management repositories.</span>
<span class="go">Adding repo from: file:///home/user/sgx_rpm_local_repo</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before running the installer, perform <a class="reference internal" href="../appendix.html#performing-integrity-checks"><span class="std std-ref">an integrity check</span></a> first.
Also, make sure that the installer is appropriate for the machine’s OS.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If errors were encountered during installation, details will be logged to <code class="docutils literal notranslate"><span class="pre">/var/log/kriptakey</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please contact <a class="reference external" href="mailto:support&#37;&#52;&#48;klaviskripta&#46;com">support<span>&#64;</span>klaviskripta<span>&#46;</span>com</a> if any problems were encountered during installation.</p>
</div>
</section>
<section id="installing-kk-cryptoservice">
<h2>Installing KK-Cryptoservice<a class="headerlink" href="#installing-kk-cryptoservice" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Install KK-Cryptoservice from the RPM package. Note that KK-Cryptoservice depends on the packages
in <code class="docutils literal notranslate"><span class="pre">sgx_rpm_local_repo</span></code>. However, these packages are not signed with GPG. Hence, it must be installed
without performing the GPG check.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>dnf<span class="w"> </span>--nogpgcheck<span class="w"> </span>install<span class="w"> </span>kk-cs-2.0-0000.el8.x86_64.rpm
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The installer automatically creates the user <code class="docutils literal notranslate"><span class="pre">kripta</span></code>.</p></li>
<li><p>The user <code class="docutils literal notranslate"><span class="pre">kripta</span></code> can only read files from the working directory.</p></li>
<li><p>The administrator, using their usual user account, <strong>cannot</strong> write directly to the working directory.
Files must be moved as the user <code class="docutils literal notranslate"><span class="pre">kripta</span></code> to the working directory.</p></li>
<li><p>During the installation process, the location of the working directory must be specified.
It is highly recommended to use the default value.</p></li>
</ul>
</div>
</li>
<li><p>After successfully installing KK-Cryptoservice, it must be configured by running its configuration script.
This will configure settings such as port, log level, SNMP server, and so on. Do note the following
when running the configuration script:</p>
<ul class="simple">
<li><p>The port may be any port from 1024 to 49151, inclusive.</p></li>
<li><p>Using KK-Cryptoservice for functional module testing is optional. Set this to true to activate the APIs
for functional module testing.</p></li>
<li><p>Configuring the SNMP server is optional — errors are still recorded to the log file. However, it is
strongly recommended to configure the SNMP server so that critical alerts from Kripta Key can be
noticed promptly. To configure the SNMP server, the administrator must prepare the SNMP host and port,
SNMP username, SNMP authentication passphrase, and SNMP privacy passphrase.</p></li>
<li><p>For some configuration fields, the script will set a default value if value is omitted when prompted.</p></li>
<li><p>The working directory must be writable by the <code class="docutils literal notranslate"><span class="pre">kripta</span></code> user. For this reason, it is recommended
to use the default value, <code class="docutils literal notranslate"><span class="pre">/var/local/kriptakey/kk-cryptoservice</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Sample output if SNMP server has not been configured.</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>/opt/kriptakey/kk-cryptoservice/kk-cs.sh

<span class="go">KK-Manager instance host address []: 10.30.0.116</span>
<span class="go">KK-Manager instance port []: 8086</span>
<span class="go">KK-Cryptoservice port for REST API endpoint [7003]: 8087</span>
<span class="go">KK-Cryptoservice port for SDK API endpoint [7004]: 8088</span>
<span class="go">Utilize KK-Cryptoservice as functional module testing endpoint [y/N]: y</span>
<span class="go">SNMP server host and port in xxx.xxx.xxx.xxx:xxxx format []:</span>
<span class="go">WARNING: SNMP server address is empty. KK-Cryptoservice will not send SNMP alerts.</span>
<span class="go">KK-Cryptoservice log level (Option: ERROR/INFO/DEBUG) [ERROR]:</span>
<span class="go">KK-Cryptoservice working directory path [/var/local/kriptakey/kk-cryptoservice]:</span>

<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/db from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/txncount from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/backup from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/sgxdata from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /etc/kriptakey/kk-csd.conf from unconfined_u:object_r:etc_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>

<span class="go">WARNING: Configure your firewall to allow the KK-Cryptoservice service.</span>

<span class="go">Configuration file has been written successfully to /etc/kriptakey/kk-csd.conf.</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Sample output if SNMP has been configured.</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>/opt/kriptakey/kk-cryptoservice/kk-cs.sh

<span class="go">KK-Manager instance host address []: 10.30.0.116</span>
<span class="go">KK-Manager instance port []: 8086</span>
<span class="go">KK-Cryptoservice port for REST API endpoint [7003]: 8087</span>
<span class="go">KK-Cryptoservice port for SDK API endpoint [7004]: 8088</span>
<span class="go">Utilize KK-Cryptoservice as functional module testing endpoint [y/N]: y</span>
<span class="go">NMP server host and port in xxx.xxx.xxx.xxx:xxxx format []: 192.168.0.5:1337</span>
<span class="go">SNMP username []: klavis</span>
<span class="go">SNMP authentication passphrase []: klavisauth</span>
<span class="go">SNMP privacy passphrase []: klavisencrypt</span>
<span class="go">KK-Cryptoservice log level (Option: ERROR/INFO/DEBUG) [ERROR]:</span>
<span class="go">KK-Cryptoservice working directory path [/var/local/kriptakey/kk-cryptoservice]:</span>

<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/db from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/txncount from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/backup from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /var/local/kriptakey/kk-cryptoservice/sgxdata from unconfined_u:object_r:var_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>
<span class="go">Relabeled /etc/kriptakey/kk-csd.conf from unconfined_u:object_r:etc_t:s0 to system_u:object_r:kk_csd_var_t:s0</span>

<span class="go">WARNING: Configure your firewall to allow the KK-Cryptoservice service.</span>

<span class="go">Configuration file has been written successfully to /etc/kriptakey/kk-csd.conf.</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To configure the SNMP server, please refer to <a class="reference internal" href="../appendix.html#snmp-configuration"><span class="std std-ref">SNMP configuration</span></a>.</p></li>
<li><p>To unset the SNMP configuration, omit the SNMP destination when prompted by the script.</p></li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The configuration file for KK-Manager is stored in <code class="docutils literal notranslate"><span class="pre">/etc/kriptakey/kk-csd.conf</span></code>. Do not move
or remove the file to ensure the smooth operation of the service.</p>
</div>
</li>
<li><p>If you choose to enable SNMP, there is an additional step.
Kripta Key appliance is accompanied by script that will send crucial system information (CPU, Memory and
Disk utilization) using SNMP if SNMP is configured. The script will automatically send SNMP message every minute.
To enable this script, execute command below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>/opt/kriptakey/kk-sys_snmp.sh<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p>Check the version of the daemon to ensure that KK-Manager has been installed properly.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>-u<span class="w"> </span>kripta<span class="w"> </span>kk-csd<span class="w"> </span>--version

<span class="go">Module: kk-csd</span>
<span class="go">Version: &lt;version&gt;</span>
</pre></div>
</div>
</li>
<li><p>Reload the firewall service and set the zone as shown below. You can set the zone to either public or private.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--permanent<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-service<span class="o">=</span>kk-csd

<span class="go">success</span>

<span class="gp">$ </span>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--reload

<span class="go">success</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="registering-kk-cryptoservice">
<h2>Registering KK-Cryptoservice<a class="headerlink" href="#registering-kk-cryptoservice" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Fetch the machine platform information. Run the following command on each KK-Cryptoservice machine.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>-u<span class="w"> </span>kripta<span class="w"> </span>kk-csd<span class="w"> </span>--get-pck-id

<span class="go">Platform information successfully written to /var/local/kriptakey/kk-cryptoservice/sgxdata/39288AC7XXXXXXXXXXXXXXXXXXXXXXXX.json</span>
</pre></div>
</div>
</li>
<li><p>Copy the platform information of the KK-Cryptoservice machines to a device that has CLIKK installed.</p></li>
<li><p><a class="reference internal" href="../appendix.html#obtaining-intel-api-key"><span class="std std-ref">Obtain an API key from Intel</span></a> if the administrator lacks one.
This API key will be used to retrieve collateral from Intel using CLIKK. The collateral file contains information
that attests that the hardware in use truly came from Intel, as opposed to being simulated.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">clikk</span> <span class="pre">conf</span> <span class="pre">get-collateral</span></code>, passing the API key and the path to the platform information to fetch
the collateral for the KK-Cryptoservice machines.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The machine must be connected to the internet.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clikk<span class="w"> </span>conf<span class="w"> </span>get-collateral<span class="w"> </span>--intel-api-key<span class="o">=</span>39949131XXXXXXXXXXXXXXXXXXXXXXX<span class="w"> </span>--platform-info-path<span class="o">=</span>/home/user/documents/39288AC7XXXXXXXXXXXXXXXXXXXXXXXX.json<span class="w"> </span>--output-dir-path<span class="o">=</span>/home/user/documents

<span class="go">This will fetch attestation material from Intel&#39;s trusted web service:</span>
<span class="go">    https://api.trustedservices.intel.com/sgx/certification/v4</span>
<span class="go">Type `ew!O3` to continue, or press Enter to cancel.</span>
<span class="go">&gt; ew!O3</span>

<span class="go">PCK certificate has been saved successfully to /home/user/documents/pck_cert_39288AC7XXXXXXXXXXXXXXXXXXXXXXXX.pem.</span>
<span class="go">Quote collateral has been saved successfully to /home/user/documents/collateral_0BF32AXXXXXX.json.</span>
</pre></div>
</div>
</li>
<li><p>Copy the respective PCK certificates and collaterals to the working directories of each KK-Cryptoservice machines.</p></li>
<li><p>Run KK-Cryptoservice in registration mode, passing in the path to the KK-Cryptoservice machine’s PCK certificate
and the latest database backup file.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Ensure the integrity of the backup file. Perform the following steps:</p>
<ul class="simple">
<li><p>Compute the hash of the backup file in the KK-Manager machine, preferably as soon as the backup is created.</p></li>
<li><p>Compute the hash of the backup file in the KK-Cryptoservice machine.</p></li>
<li><p>Compare both hashes. Confirm that the hashes are the same before proceeding.</p></li>
</ul>
<p>To compute the hashes, use a tool such as <code class="docutils literal notranslate"><span class="pre">sha256sum</span></code>.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>-u<span class="w"> </span>kripta<span class="w"> </span>kk-csd<span class="w"> </span>--kk-cryptoservice-pck-cert<span class="o">=</span>/var/local/kriptakey/kk-cryptoservice/sgxdata/pck_cert_39288AC7XXXXXXXXXXXXXXXXXXXXXXXX.pem<span class="w"> </span>--database-backup-path<span class="o">=</span>/path-to-database-backup/backup.db

<span class="go">Commencing the KK-Cryptoservice registration process.</span>
<span class="go">This will initialize a KK-Cryptoservice instance on this machine and register it to the KK-Manager instance.</span>
<span class="go">Any existing KK-Cryptoservice database file will be OVERWRITTEN.</span>
<span class="go">Do not interrupt the process until the message &quot;KK-Cryptoservice has been registered successfully to KK-Manager.&quot;.</span>
<span class="go">Are you sure you want to continue? Type `&#39;Q\y2` to continue, or press Enter to cancel.</span>
<span class="go">&gt; &#39;Q\y2</span>

<span class="go">[-] Ready for initialization and registration.</span>
<span class="go">[-] Listening on port 8086...</span>
<span class="go">[-] Waiting for connection from KK-Manager...</span>
</pre></div>
</div>
</li>
<li><p>Register the KK-Cryptoservice instance to the main KK-Manager instance using CLIKK, passing in the path
to the collateral file obtained above.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>clikk<span class="w"> </span>kk-cryptoservice<span class="w"> </span>add<span class="w"> </span>--kk-manager-collateral-path<span class="o">=</span>/home/user/documents/collateral_00A065XXXXXX.json<span class="w"> </span>--kk-cryptoservice-collateral-path<span class="o">=</span>/home/user/documents/collateral_0BF32AXXXXXX.json<span class="w"> </span>--kk-cryptoservice-host<span class="o">=</span><span class="m">10</span>.30.0.2<span class="w"> </span>--kk-cryptoservice-port<span class="o">=</span><span class="m">8086</span><span class="w"> </span>--kk-cryptoservice-name<span class="o">=</span>kk-csOne

<span class="go">Enter admin ID: Admin1</span>
<span class="go">Enter password:</span>
<span class="go">Insert the administrator card of Admin1 for two-factor authentication.</span>

<span class="go">Dual control authentication -- credential of second user is required.</span>
<span class="go">Admin1 is currently logged in.</span>

<span class="go">Enter admin ID: Admin2</span>
<span class="go">Enter password:</span>
<span class="go">Insert the administrator card of Admin2 for two-factor authentication.</span>

<span class="go">KK-Cryptoservice `KK-CSOne` at 10.30.0.2 has been registered successfully.</span>
</pre></div>
</div>
</li>
<li><p>Once the registration process has been completed, KK-Cryptoservice will show the following message:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[v] KK-Cryptoservice has been registered successfully to KK-Manager.</span>
</pre></div>
</div>
</li>
<li><p>Start the KK-Auditor service, and check that it is running properly.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>kk-csd.service<span class="w"> </span>--now

<span class="gp">$ </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>kk-csd.service
</pre></div>
</div>
</li>
<li><p>Ensure that the KK-Cryptoservice instance is connected to the KK-Manager instance, using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with
the KK-Manager host and port.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-k<span class="w"> </span>-v<span class="w"> </span><span class="m">10</span>.30.0.116<span class="w"> </span><span class="m">8086</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="kripta-key-installation.html" class="btn btn-neutral float-left" title="Installing Kripta Key" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="disaster-recovery.html" class="btn btn-neutral float-right" title="Disaster recovery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, PT Klavis Kripta Inovasi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>